## 什么是集成测试？

集成测试是对包含两个或多个集成组件的子系统进行测试。一旦各个组件经过单元测试并且它们按预期工作，就会执行它。其目的是发现接口中的缺陷以及集成组件之间的交互。

[让我们以亚马逊](https://www.amazon.in/)网站为例来理解它。让我们看一下 Amazon.in 网站的一些模块。

-   你的帐户(你的订单、你的地址、登录名、付款方式)
-   搜索
-   产品列表页面
-   产品详情页面
-   大车
-   结帐流程(登录、地址选择、交货选项选择、付款方式选择、查看订单、订单确认)

亚马逊网站的基本用户工作流程如下所示。每个箭头代表模块之间的集成。

![集成测试](https://toolsqa.com/gallery/ISTQB%20Certification/1.Integration-Testing.png)

1.  用户将在亚马逊上搜索商品/关键字，然后他将被带到搜索结果页面，该页面也称为PLP(产品列表页面)。
2.  一旦用户选择了产品，他将被带到PDP(产品详细信息页面)。
3.  用户可以选择产品的尺寸和颜色并将产品添加到他的购物车。
4.  此后，结帐过程将开始，要求用户登录。
5.  登录后，将要求用户选择一个地址(结帐时的地址是从我的帐户 模块中给出的地址填充的)。
6.  选择地址后，将要求用户选择一种付款方式(同样，付款方式来自保存在我的帐户中的付款方式)。
7.  用户完成付款后，订单确认页面将显示订单 ID(相同的订单 ID 转到我的帐户订单详细信息)

通过上述工作流程，你可以看到亚马逊网站的不同模块是如何集成的，以及数据如何从一个模块流向另一个模块。

单独测试这些模块中的每一个称为组件测试，但是当我们以集成方式测试这些模块时，则称为集成测试。例如，确保保存在我的帐户中的付款方式反映在Checkout的付款方式选项中是一种集成测试形式(称为组件集成测试 - 更多详细信息见下文)

### 集成测试的测试基础

测试依据是指可以从中推断出组件或系统需求的所有文档。每个测试级别都有一个测试基础，应该参考它来为该[测试级别创建场景。](https://www.toolsqa.com/software-testing/test-levels/)让我们看一下集成测试的测试基础：

-   显示每个模块如何连接到另一个模块的软件和系统设计。
-   显示每个模块/接口如何与另一个交互的序列图。它显示了交互发生的顺序，以及传递的信息
-   显示每个模块如何与另一个模块通信的接口和通信协议规范。一些交互机制可能是基于 XML 或 JSON 的。
-   用例：用例定义了参与者为实现目标而执行的操作。参与者代表不同的用户类型。例如，对于火车票预订应用程序，参与者可以是客户、代理和管理员。代理的用例可能是代表客户预订机票。
-   架构图：架构图表示整个系统并显示组件和系统之间的交互。这还包括与第三方和外部系统的交互。
-   工作流程：它显示了系统中可能的端到端旅程的不同变化。这些可用于创建系统集成场景
-   外部接口定义：这显示了与集成的外部系统的交互机制。例如，电子商务网站中显示的产品评论由 Bazaarvoice 等独立第三方管理。接口定义将包括 Bazaarvoice 为集成提供的 JavaScript API 详细信息。

### 集成测试的测试对象

测试对象描述了在测试级别中应该测试的内容。这是指组件、集成组件或整个系统。由于每个测试级别都有不同的测试对象，所以让我们来看看一些关键的测试对象：-

-   子系统：当一个系统的两个或多个组件集成在一起时，它们就形成了一个子系统。该子系统作为集成测试的一部分进行测试。例如，对于 Flipkart 网站，一旦登录和个人资料页面准备就绪，它们就会形成一个子系统，并且可以开始组件集成测试，而无需等待我帐户中的地址或支付功能。
-   数据库：它通常作为组件集成测试的一部分进行测试，任何导致数据库更新的 UI 操作都在此处进行测试。例如，当你在 Flipkart 网站上注册时，会创建帐户详细信息并将其存储在数据库中。当用户尝试使用相同的用户 ID 注册另一个帐户时，这些帐户详细信息将得到验证。此外，个人资料页面会获取其中一些信息。因此，作为组件集成测试的一部分，验证是否将正确的条目存储在 DB 中变得很重要。
-   接口： 接口定义了一个组件如何与另一个组件交互。它还定义了系统之间的交互。集成测试验证这些接口是否按照规范工作。例如，网站上的股票信息可以来自数据库的实时信息，也可以作为夜间批处理作业的一部分。重要的是要考虑如何定义接口，以便可以相应地完成集成测试。
-   API：应用程序编程接口定义了各种组件之间的通信方法。这些 API 是作为集成测试的一部分进行测试的。
-   微服务： 这是一种将单个应用程序开发为一组较小服务的方法，每个服务都运行自己的进程。这些服务可以单独部署和维护。集成测试侧重于测试这些服务之间的交互。

### 集成测试中的典型缺陷和失败

由于每个测试级别的测试目标不同，因此在这些级别中发现的缺陷类型也不同。让我们来看看一些常见的缺陷类型：

-   接口不匹配和错误排序：回到我们之前的亚马逊网站示例，假设在我的帐户中，电话号码对于一个人添加地址时是可选的，但是当他去结账并尝试选择相同的地址时，结账流程需要它是强制性的。在这种情况下，所选地址将不起作用。这是组件集成测试的接口不匹配的经典示例。在其他情况下，接口可能会在调用其他组件的顺序上出错。例如，在 Flipkart 网站上，当用户单击订单确认下订单时，首先调用库存检查组件以确保库存仍然存在，一旦发生此检查，则调用支付组件来验证支付方式。想象一下，如果开发人员弄乱了顺序，
-   组件间通信失败：当两个组件或系统集成时，建立了通信协议，可能是XML或JSON等。通常在建立这种通信时出现问题，组件无法通信彼此。这是最普遍和最常见的集成缺陷之一。当这些通信故障没有得到正确处理时，就会出现其他缺陷。例如，如果支付系统宕机，如果失败处理不当，会导致 404 错误页面，但如果处理成功，用户将停留在结帐页面，并显示信息性错误消息以供尝试稍后再试。
-   不正确的假设：当集成系统做出证明不正确的假设时，通常会出现集成缺陷。例如，对于与 Google Address API 的地址查找集成，假设用户可以输入地址，Google API 将确认地址是否正确，否则将显示修改后的地址。当 google API 根本无法理解该地址时，这个假设就会失败，它会被迫给出一个无法给出任何结果的错误。在这种情况下，网站必须提供手动输入地址的选项，否则集成将失败，输入地址的功能将无法使用。

### 集成测试的目标

集成测试降低了在系统测试阶段发现集成组件缺陷的风险。集成缺陷的修复可能很复杂，而且它们也可能很耗时。在周期的早期找到它们可以消除在系统测试阶段进行过多更改的风险。由于每个集成组件都在集成阶段进行了测试，因此系统测试可以专注于端到端的旅程和用户特定的流程。

-   通过在集成组件可用时对其进行测试来降低风险。
-   验证接口的功能和非功能行为是否按照规范设计。
-   建立对接口质量的信心。
-   查找组件、系统或接口中的缺陷。
-   防止缺陷逃逸到更高测试级别的测试，即系统测试。

## 集成测试的级别

集成测试可以是组件集成测试或系统集成测试。

### 组件集成测试

它侧重于系统组件之间的交互。例如，对于 Flipkart 网站，订单详情页面和购物车页面之间的交互可以归类为组件集成测试。当单个组件已被认证为组件测试的一部分时，将完成组件集成测试。这通常由开发人员完成，并且通常是自动化的。在敏捷开发中，组件集成测试通常是持续集成过程的一部分。

### 系统集成测试

它侧重于系统或微服务之间的交互。通常，它涵盖了所有第三方集成。例如，Flipkart 产品详细信息页面可以选择通过 Twitter 和 Facebook 共享产品。这两个都是第三方应用程序，与 Twitter 和 Facebook 的这种集成属于系统集成测试。

下面列出了集成测试的一些关键注意事项：

-   确保接口的功能和非功能行为按照设计工作。
-   接口、API 和微服务通常包含在其中。
-   只要两个交互组件准备好进行测试，它就会执行，而无需等待整个系统准备好。这可确保及早发现缺陷，并有助于将缺陷与特定组件交互隔离开来。
-   组件集成测试通常是开发人员的责任，尽管测试团队可以平等地参与。系统集成测试通常是测试团队的责任。
-   开发组织不控制外部接口，这会给测试带来各种挑战(例如，确保解决外部组织代码中的测试阻塞缺陷、安排测试环境等)。系统集成测试可以在系统测试之后进行，也可以与正在进行的系统测试活动并行进行(在顺序开发和迭代和增量开发中)。

## 集成测试方法和职责

集成测试是最重要的[测试级别](https://www.toolsqa.com/software-testing/test-levels/)之一，我们必须了解它的方法和目标。它应该只关注集成方面，而不是因为测试单个组件而忘乎所以。例如，对于亚马逊网站，如果Cart模块与Checkout集成，那么重点应该是测试集成，而不是Cart和Checkout本身。应在组件级测试中检查各个模块。

组件集成测试通常由开发团队完成，尽管测试团队可以帮助他们。系统集成通常是测试团队的责任。

集成方法和测试策略在开始集成测试之前完成。这种方法包括测试数据、通信协议、我们使用的是真实服务还是模拟服务(例如，用于测试支付集成，将使用虚拟卡)

集成测试的范围应该保持最小。假设一个系统包含 20 个组件，因此一旦 2 个集成组件准备就绪，集成测试就应该开始，而不是等待其余的组件。这有助于将任何集成缺陷隔离到仅 2 个组件，并有助于更轻松地调试和修复时间。与大爆炸的方法相比，这种持续集成测试方法如今变得非常流行。

集成测试应尽可能使用真正的集成进行，但出于时间考虑，通常会使用存根。[存根](http://www.toolsqa.com/blogs/differences-between-stubbing-and-mocking/)是模拟软件组件行为的程序。例如，当测试人员下订单时，Checkout组件调用Payment组件进行信用卡身份验证。验证成功后，将显示订单确认页面。现在想象一下Checkout and Order Confirmation页面已准备就绪，但Payment组件仍在开发中。在这种情况下，支付组件可以被存根所以它总是会给出一个成功的响应，测试人员可以测试结帐流程和订单确认页面。虽然存根具有在生命周期早期测试组件的优势，但它的缺点是一旦真正的集成准备好就需要再次测试集成。测试方法应该平衡存根和实际集成。

让我们看一下我们的项目中可以遵循的一些集成策略。

![集成测试类型](https://toolsqa.com/gallery/ISTQB%20Certification/2.Integration%20Testing%20Types.png)

### 大爆炸集成测试

这意味着我们等待所有组件准备好并集成，然后一次性对所有组件进行测试。这通常在按顺序工作的瀑布模型中使用，但在敏捷模型中避免使用。

### 增量集成测试

在这种方法中 - 集成测试在两个或更多组件集成后立即开始，而不是等待其他组件可用。这种方法有助于将范围保持在最小范围，从而确保可以轻松地将缺陷隔离到这些组件中。此外，增量集成可确保在周期的早期发现缺陷，从而降低修复缺陷的成本。

增量测试可以进一步分类为：

-   自下而上的集成测试：自下而上的测试是指集成是指将较低级别的模块与较高级别的模块进行测试，直到我们覆盖整个系统。
-   自顶向下集成测试：自顶向下正好相反，这里我们测试顶层的模块和低层的模块，直到覆盖整个系统。
-   三明治集成测试：三明治集成是一种混合方法，我们从顶部和底部并行测试，直到到达中间层并覆盖整个系统。