在我们之前的教程中，我们已经熟悉了[基本授权](https://toolsqa.com/postman/basic-authentication-in-postman/)，我们使用用户名和密码获得了对服务器的访问权限。还有另一种类型的授权称为OAuth，它与基本授权有点不同。我们对主要应用程序使用基本授权，其中用户名和数据允许我们进入组织的服务器，然后我们可以看到带有适当请求的响应。另一方面，OAuth旨在让第三方应用程序以某种形式的安全性访问用户数据。OAuth 2.0授权

它有两个版本OAuth 1.0和OAuth 2.0。但我们不会关注OAuth 1.0，而是了解OAuth 2.0，因为它是当今的标准并且使用最广泛。我将在下一节中详细解释所有这些。在本教程中，我们将重点关注

-   什么是 OAuth 2.0？
-   OAuth 2.0 角色
-   访问令牌和授权服务器
-   OAuth 与 OAuth 2.0
-   Oauth 2.0 的工作流程

## 什么是 OAUTH 2.0？

OAuth 2.0是行业标准的授权协议，通常被推荐使用。OAuth 2.0取代了 2006 年创建的原始OAuth协议所做的工作。OAuth 2.0 侧重于简化客户端开发人员，同时为 Web 应用程序、桌面应用程序、手机和客厅设备提供特定的授权流程。它更像是一个技术术语。简单来说， OAuth 2.0是一个授权框架，它使应用程序能够获得对 HTTP 服务(例如 Facebook 和 GitHub)上的用户帐户的有限访问权限。它向第三方用户提供其拥有的用户帐户的访问权限。这是OAuth 2.0 的主要工作。

### OAuth 角色

OAuth定义了四种角色：

资源所有者/用户： 用户是帐户所有者，他在网站的数据库中拥有自己的帐户，他将从该网站授权另一个网站访问他的帐户。不用说，访问权限仅限于授权的“范围”，即，将仅授予用户想要的访问权限。

客户端/第三方应用程序： 该应用程序是用户访问其帐户的软件，或者我们可以说该应用程序在用户允许后从另一个网站访问用户的帐户详细信息。用户的授权过程必须由应用程序的 API 和第三方网站进行验证。

资源/授权服务器： 资源服务器是拥有主机帐户的服务器。例如，Facebook 的资源服务器将在它的数据库中拥有它的用户帐户，只能通过他的服务器访问。授权服务器用于在用户授予他允许应用程序访问他的帐户详细信息(在范围内)之后生成访问令牌。

从应用程序开发人员的角度来看，服务的 API 既可以充当资源服务器角色，也可以充当授权服务器角色。我们将把这两个角色结合起来称为 服务 或 API 角色

### 访问令牌和授权服务器

Access Token是用户本人在应用程序中批准访问数据的保证。当服务器看到访问令牌时，可以确定应用程序具有访问数据的适当权限。由于访问令牌非常重要，我们需要一些能够负责任地处理此任务的东西。这是由授权服务器完成的。此授权服务器向客户端应用程序颁发令牌以访问来自服务器的数据。

更深入的理解，token分为三个部分

-   标头部分：包含令牌的内容
-   有效负载部分：包含服务器需要发回的内容，例如姓名、个人资料图片等。
-   签名部分：此部分包含为安全而加密编码的签名。

你一定很熟悉这个屏幕。每当你在任何网站上通过 Facebook 注册时，都会出现此屏幕。

![facebook_signup_permission](https://www.toolsqa.com/gallery/Postman/1.facebook_signup_permission.jpg)

这需要你的许可，以确认是谁在批准第三方应用程序访问你的有限详细信息。此详细信息因网站而异。有些可能只需要个人资料照片，有些可能需要你的详细信息和照片。访问令牌中包含应用程序想要的详细信息类型的详细信息。由于我们无法提供完整的信息作为安全措施，因此需要此功能。

### OAuth 1 与 OAuth 2.0

-   用户体验： OAuth 1 是较早的授权形式，非常复杂，受到公司和用户的负面响应。在 OAuth 1.0 中，你必须打开浏览器，登录网站，然后公司或网站(如 Twitter)会提供令牌。然后需要将此令牌粘贴到应用程序中。这对用户体验来说是一个巨大的打击。
-   OAuth 1 令牌长期存在。它们过去常常在很长一段时间后过期，而一些像 Twitter 这样的令牌永远不会过期。
-   OAuth 1 要求随每个 API 调用一起发送 2 个令牌。

## OAuth 2.0 的工作流程

到目前为止，我们已经了解了OAuth 2.0 授权的术语和细节。在本节中，我们将清楚地说明你如何通过OAuth 2.0 授权访问你的信息。

假设你正在注册一个名为Book A Flight的客户端应用程序。此应用程序需要你的详细信息，例如出生日期、个人资料照片和你的兴趣。因此，你有两种方法可以将此信息提供给Book A Flight 应用程序。 你可以通过填写电子邮件 ID 和密码的详细信息使用直接方法注册。之后，你需要填写完整的详细信息并上传图片。

另一种选择是，你可以通过给定的选项通过 Facebook 登录，一切都会自动准备好，无需你手动操作。这是简单而真实的。所以我们选择这种方式。

![结合](https://www.toolsqa.com/gallery/Postman/2.Combine.png)

只要你单击 Facebook 按钮，就会打开一个弹出窗口，让你提供在 Facebook 上的访问权限。如下图所示，它在 Facebook 上请求你的许可，以便它知道你允许与第三方 App“ Book a Flight ”共享你的数据。但是 Facebook 怎么知道这是哪个网站，因为 FB 可以只允许每个 App 使用他们的用户数据。

![移动应用程序 Facebook 权限页面](https://www.toolsqa.com/gallery/Postman/3.Mobile%20Application%20Facebook%20Permission%20Page.png)

注意 : 要获得Facebook 访问页面，Client Application 需要注册到Facebook。

### 使用 FB/Twitter/LinkedIn 等进行客户端应用程序注册

在将 Facebook 显示为可用的注册选项之前，客户端应用程序需要向 FB 应用程序注册。要获得它，它需要向 Facebook 提供回调 URL ，以便 Facebook 知道在你通过 Facebook 签名后重定向到哪里。

![回调地址](https://www.toolsqa.com/gallery/Postman/4.CallBack%20URL.png)

注意：要获得有关回调 URL 的更多信息，你可以访问有关Postman 中的 OAuth 2.0 授权教程的教程。

Application注册后，Facebook会提供一个Client Id和Client Secret给应用，这两个很重要。这些被用作网站/应用程序的唯一标识符，因为许多网站都在 Facebook 注册。

-   客户端 ID：这是一个 ID，就像你在办公室或大学中获得的一样，以便你被唯一识别。这里客户端需要被 Facebook 唯一标识为一个应用程序，因此它被提供了一个 id。
-   Client Secret：这就像一个不能共享的密码。每次应用程序发出请求时，Facebook 都会将客户端密码用作身份验证标识符。

注意：以上几点与用户无关。这是由应用程序所有者完成和设置的。值得了解。

### 第三方应用的用户授权

第1步： 现在回到用户授权，当你使用Facebook的用户名和密码登录时，系统会要求你允许权限。 这称为授权授予。简单来说，grant 意味着同意某事。因此，我们在这里授权 Facebook 向第三方应用程序提供所需的详细信息，在我们的例子中是预订航班。

![授权授予](https://www.toolsqa.com/gallery/Postman/5.Authorization%20Grant.png)

第 2 步： 由于应用程序已授予对用户 FB 帐户的访问权限，现在应用程序 通过提供其身份验证和授权授予，从授权服务器 (API)请求访问令牌。如果应用程序身份通过身份验证且授权授予有效，则 授权服务器 (API)会向应用程序颁发访问令牌。授权完成。

![访问令牌](https://www.toolsqa.com/gallery/Postman/6.Access%20Token.png)

注意：Token 是对拥有实际数据的 Resource Server 的保证，Authorization Grant 是对 Authorization Server 生成 access token 的保证。

第 3 步： 应用 程序向资源服务器 (API)请求资源 并出示访问令牌以进行身份验证。如果访问令牌有效，则 资源服务器 (API)会将资源提供给 应用程序。

![OAuth 2.0授权](https://www.toolsqa.com/gallery/Postman/7.OAuth%202.0%20Authorization.png)

注意：对授权服务器的请求还包含应用程序需要的详细信息。例如，如果它只需要个人资料图片或其他任何东西。相应地生成令牌，以便当我们将此令牌显示给资源服务器时，它只提供所需的数据而不是所有数据。

上述步骤中给出的完整流程是 OAuth 2.0 授权流程。通过这个，我们可以轻松地从其他应用程序管理我们的详细信息。在下一个教程中，我们将使用 Postman 和Imur Application执行相同