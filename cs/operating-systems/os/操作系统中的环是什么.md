## 1. 概述

在本教程中，我们将解释操作系统中的保护环是什么以及我们为什么需要它们。我们还将讨论不同级别的保护环和不同处理器架构中的实现细节。

## 2. 操作系统中的环是什么？

操作系统有许多不同的层。这些层中的每一层都有自己的特权。我们在提到该系统时使用保护环术语。操作系统管理计算机资源，例如 CPU 上的处理时间和访问内存。由于计算机运行多个软件进程，这会带来一些问题。保护环是共享资源和硬件的关键解决方案之一。

因此，进程在这些保护环中执行，每个环都有自己的资源访问权限。中央环具有最高特权。外面的人比里面的人享有更少的特权。下图表示[x86](https://en.wikipedia.org/wiki/X86)处理器架构的保护环，这是一种常见的处理器架构。

正如我们所见，它有四个编号从 0 到 3 的环：

![1环3](https://www.baeldung.com/wp-content/uploads/sites/4/2022/03/1_rings3-1024x678.png)一种

## 3. 为什么我们需要它们？

在操作系统中实施保护环有一些优点和好处。

首先，它可以保护系统免于崩溃。例如，我们在计算机中使用的应用程序可能会冻结或崩溃，但是，我们可以通过重新启动应用程序来恢复它们。像这样的更高环中的错误是可以恢复的。

因为这些程序不能直接访问内存或 CPU。只有ring 0，[内核](https://www.baeldung.com/cs/os-kernel)可以直接访问硬件资源。这样，我们就可以在不丢失数据或导致 CPU 出错的情况下重启应用程序。

此外，保护环提供更高的安全性。例如，进程可能需要一些需要更多 CPU 资源的指令。在这种情况下，此进程必须请求操作系统的许可。操作系统可以决定是批准请求还是拒绝请求。此过程可保护系统免受恶意行为的侵害。

## 4.保护戒指的等级

### 4.1. 环 0

内核是操作系统的核心，可以访问所有内容，可以访问 Ring 0。这里运行的代码被称为内核模式。内核模式进程有可能影响整个系统。如果这里出现问题，系统很可能会崩溃。因为这个环可以直接访问 CPU 和系统内存。

### 4.2. 环 3

以用户模式运行的用户进程可以访问 Ring 3。因此，这是权限最低的环。这是我们可以找到大部分计算机应用程序的地方。由于此环无法访问 CPU 或内存，因此涉及这些的任何指令都必须传递给环 0。

### 4.3. 环 1 和环 2

另一方面，环 1 和环 2 提供了环 3 所缺乏的独特优势。操作系统使用环 1 与计算机硬件进行交互。这个戒指需要运行命令，例如通过我们监视器上的摄像头流式传输视频。必须与系统存储、加载或保存文件交互的指令存储在环 2 中。

这些权限称为输入和输出权限，因为它们涉及将数据传入和传出工作内存 RAM。

例如，在环 2 中，从存储中加载 Excel 文件文档。在这种情况下，ring 3 将负责编辑和保存数据。

## 5.如何实现保护环？

大多数 CPU 架构(例如 x86)都包含某种形式的保护环。但是，某些操作系统(如 Linux、macOS 和 Windows)并未充分利用这些功能。虽然 Linux 和 Windows 仅使用 ring 0 和 ring 3，但其他一些操作系统可以使用三个不同的保护级别。

另一方面，作为其他常见处理器架构之一的 ARM 7 实现了三个特权级别：应用程序、操作系统和管理程序。ARM 8 实现了四个保护级别。除了 ARM 7 中的现有级别外，它还添加了一个安全监控级别。

正如我们所讨论的，ring 0 和 ring 3 是基本级别，ring 1 和 ring 2 是可选保护级别。

## 六，总结

在本教程中，我们定义了保护环和此类系统的主要用途。然后，我们还讨论了不同级别的保护环及其职责。

最后，我们分享了有关在不同处理器架构和操作系统中实现保护环的详细信息。