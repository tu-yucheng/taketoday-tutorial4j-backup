## 1. 概述

在本教程中，我们将讨论两种最流行的非连续内存分配技术：分段分页和分页分段。我们将探讨这两种方法的工作方式、优缺点。

最后，我们将介绍它们之间的核心区别。

## 2.动机

计算机内存容量的最佳使用一直是广泛研究的主题。随着计算机的进步，程序也变得越来越复杂，需要更多的内存来执行。

在任何机器上，我们都需要在多个程序之间共享内存。但是，它可能会导致处理速度变慢，因为 CPU 需要为它们中的每一个将数据加载到 RAM 中。

我们无法确定一台计算机上可以执行多少个程序的极限。因此，RAM 的大小对于现代计算机来说永远不够用。

现在要解决内存问题，一种解决方案是将数据存储在辅助内存中。然后，在需要时，计算机可以将数据从辅助存储器检索到 RAM。操作系统还使用[虚拟内存](https://www.baeldung.com/cs/virtual-memory)来解决物理内存不足的问题，并为计算机分配临时内存。

这种方法的问题是，如果逻辑地址空间很大，[页表](https://en.wikipedia.org/wiki/Page_table)可能会占用 RAM 中的大量内存。因此，我们需要内存管理技术来减少页表在 RAM 中的大小。

## 3. 分段寻呼简介

为了减小 RAM 中页表的大小，我们使用了结合[分段](https://www.baeldung.com/cs/virtual-memory)和[分页](https://en.wikipedia.org/wiki/Memory_paging)的策略。但在详细介绍组合策略之前，首先让我们讨论一下分页的问题。

分页允许将作业和进程存储为内存中的不连续空间。因此，它解决了[外部碎片](https://en.wikipedia.org/wiki/Fragmentation_(computing))的问题。

为了实现这种技术，我们将进程划分为固定大小的块。这些块称为页面。我们还将物理内存划分为称为帧的固定大小的块。

当操作系统执行一个进程时，CPU将每个页面的[逻辑地址](https://en.wikipedia.org/wiki/Logical_address)转换为[物理地址](https://en.wikipedia.org/wiki/Physical_address)。此外，为访问框架而生成的地址分为页号和框架号。

分页技术的主要限制在于，当虚拟地址很大时，页面将占用实际内存中的较大空间。一般来说，程序往往很大。因此，它们会消耗大量内存。结果，某些地址将无效。

为了解决这个问题，我们可以使用分段和分页来减少页表的大小。通常，我们可以将程序分为四个段：代码段、数据段、堆栈段和堆段。

理想情况下，一个流程可以划分的段数没有限制。将流程拆分成段后，我们为每个段创建一个段表。接下来，我们将每个段划分为固定大小的页面。

这样，段表中的每个段表项都指向存储该段对应的帧地址的页表。这个过程大大减少了页表的大小。

### 3.1. 物理地址计算

当我们使用分段分页技术时，我们将 CPU 提供的地址划分为段号、页号和页偏移量。

现在要将逻辑地址转换为卷地址，我们需要帧地址。我们从段表中获取帧地址。最后，页表指向主存中段的帧：

![地址分段分页](https://www.baeldung.com/wp-content/uploads/sites/4/2021/10/AddressSegmentedPaging-2048x1490-1-1024x745.png)

让我们总结一下整个过程。首先，我们将节目分成几个部分。每个段包含一个段表。每个段表存储页表的地址。页表包含指向主存储器的帧地址。

### 3.2. 例子

让我们举个例子来理解分段寻呼技术的实际使用。我们正在使用一个带有函数的程序和它使用的数据。

我们将程序分为两部分：(A) 用于函数，(B) 用于数据。在段表中，将存在段 (A) 和 (B) 的情况。

如果 (A) 的虚拟地址是![(答：5、1、20)](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-83dd1e2b6ed2f4b82601ace2977135b2_l3.svg)：

![分段分页](https://www.baeldung.com/wp-content/uploads/sites/4/2021/10/SegmentedPaging-2048x1321-1-1024x661.png)

物理地址将是 ![mathbfbf{pa = 515 times page_size + 20}](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-e287e5c6cbebc4188489a994ace4eedd_l3.svg)。

### 3.3. 的优点和缺点

分段分页的主要优点是减少内存使用。由于它分配固定大小的页面，因此不会导致外部碎片。它使内存分配更简单。

主要缺点是[外部碎片](https://en.wikipedia.org/wiki/Fragmentation_(computing))。但是，发生外部碎片的可能性要小得多。分段寻呼技术也需要更多的硬件资源。翻译是顺序的，这增加了内存访问时间，导致更高的复杂性。页表必须是连续的才能存储在内存中。

## 4.分页介绍

在分段中，我们将每个过程划分为多个段。每个段都有不同的大小。段被加载到逻辑地址内存空间中，这是一组具有不同长度的段。

每个段都有一个名称和一个长度。为了执行一个段，它的逻辑地址被加载到物理内存空间。

通常，我们通过编号而不是名称来引用段。因此，要访问一个段，需要它的编号和偏移量。我们使用该编号作为操作系统映射的段表中的索引。偏移量的值有助于确定段的限制。

结合在一起，段号和偏移值生成物理内存空间中的段地址。

然而，分段存在许多缺点。它在物理内存中分配可变大小的块。因此，分段会导致外部碎片。

分页分段被提出作为改善内存管理的解决方案。分页分段技术包括将段表划分为页，从而减小段表的大小。在这里，我们将段划分为页面。

### 4.1. 物理地址计算

在分页中，首先我们将段表进行分页。因此，我们创建一个页表。因此，虚拟地址由四个字段组成：页号、段号、第二页号和偏移量：

![地址分页分段](https://www.baeldung.com/wp-content/uploads/sites/4/2021/10/AddressPagedSegmentation-2048x1451-1-1024x726.png)

让我们总结一下整个过程。首先，我们将节目分成几个部分。每个段都有一个段表。然后，我们还创建也包含段表地址的页表。在页表中，我们可以找到指向主存的帧地址。

### 4.2. 例子

让我们举个例子来实际理解分页技术。我们正在学习一个包含![3](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-ce2009a45822333037922ccca0872a55_l3.svg)(A)、(B) 和 (C) 片段的节目。

假设段 (C) 的虚拟地址等于![(中：10、20、5、949)](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-785c1d0ebfcc1ac71f64c2f891c69023_l3.svg)。我们需要访问它的物理地址来提取一些信息。

首先我们要知道对应的段表地址，![10^{第}](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-47f8ac80e6e02432710274cf173b5b65_l3.svg)在页表的页上。接下来，我们需要从上一个页表的表项中提取出该段对应的页表地址![20^{第}](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-acdba258767e4866eefa85f7d75201a6_l3.svg)。最后，可以在![5^{第}](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-e98ac67f21a286f22c811b4283fa848f_l3.svg)最后一个页表的页中找到帧地址并添加到偏移量中：

![分页](https://www.baeldung.com/wp-content/uploads/sites/4/2021/10/PagedSegmentation-2048x1258-1-1024x629.png)

物理地址将是 ![mathbfbf{pa = 12 times page_size + offset}](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-56fde39a00e58dce640017cf64ea4e88_l3.svg)。

### 4.3. 的优点和缺点

分页分段的主要优点是消除外部碎片并减少页表大小。

另一方面，内部碎片化问题仍未彻底解决。有时会发生内部碎片，但概率较小。当我们访问内存时存在延迟。此外，实现分页分割技术所需的硬件也很复杂。

## 5. 差异

我们来看看分页分段和分段分页的主要区别：

![由 QuickLaTeX.com 呈现](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-6e0a22a59bfad72edc302a5b12646855_l3.svg)

## 六，总结

尽管分页和分段有一些优点，但它们仍然是内存碎片的主要原因之一。为了减少内存碎片的机会，开发了组合内存管理技术。

在本教程中，我们讨论了两种内存分配技术：分段分页和分页分段。我们通过示例演示了工作过程，介绍了每种技术的基本概念。

最后，我们谈到了它们之间的核心区别。