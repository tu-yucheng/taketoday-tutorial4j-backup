## 1. 概述

在本教程中，我们将详细讨论直接内存访问 (DMA)。我们将讨论DMA的工作过程。

此外，我们还将探讨 DMA 的一些优点和缺点。

## 2.简介

在现代数字世界中，数据在计算机和设备之间不断传输。然而，计算机系统受限于它们可以处理数据的特定数据速率。因此，随着传感器、打印机和高速调制解调器等各种设备的激增，数据处理已成为瓶颈。

如果[CPU](https://www.baeldung.com/cs/cpu-guide)负责所有数据传输，它将无法同时执行任何其他操作。为了解决这个问题，开发了直接内存访问 (DMA) 控制器。它可以在不涉及 CPU 的情况下实现两个设备之间的数据传输。

DMA 是计算机和带有[微处理器](https://en.wikipedia.org/wiki/Microprocessor)的设备的一项功能，可将数据直接从主存储器传输到辅助设备，反之亦然。此外，DMA 控制器有助于在以不同速度运行的计算机组件之间进行直接数据传输。

DMA 控制器的主要功能是在不涉及 CPU 的情况下直接在内存和辅助设备之间传输数据。一些典型的操作包括从传感器和存储设备读取数据。将处理后的数据发送到打印机或网络也是 DMA 控制器执行的操作的示例。

DMA 控制器通过特殊数据通道在存储器和辅助设备之间传输数据。有两种类型的通道：数据和控制。数据通道传输实际数据。另一方面，我们使用控制通道来调节 DMA 控制器的操作。

## 3. DMA的类型

让我们谈谈不同类型的 DMA 控制器。有四种流行的 DMA 类型：单端、双端、仲裁端和交错式 DMA 控制器。

单端 DMA 控制器是简单的 DMA 控制器，通过读取和写入单个内存地址来操作。另一方面，双端 DMA 控制器是更高级的 DMA 控制器。他们可以同时从两个内存地址读取和写入。

DMA 控制器的一个更高级版本是仲裁端 DMA 控制器。它通过读取和写入多个内存地址来运行。最后，交错式 DMA 控制器是一种奇特的 DMA 控制器，它从一个内存地址读取数据，同时写入另一个不同的内存地址。

## 四、工作程序

DMA 控制器在 CPU 下工作，尽管通过 DMA 进行数据传输无需 CPU 参与。它促进了[I/O 设备](https://www.baeldung.com/cs/io-management)和[总线](https://en.wikipedia.org/wiki/Bus_(computing))之间的接口。我们可以通过 DMA 连接多个外部设备：

![工作程序](https://www.baeldung.com/wp-content/uploads/sites/4/2022/11/asasdasd.drawio-1.png)

DMA 控制器还包含三个寄存器：地址、字数和控制寄存器。为了在内存中找到目标位置，我们使用地址寄存器。字计数寄存器计算输入数据中需要传输的字数。最后，传输模式由控制寄存器指定。

DMA 控制器调节存储器和辅助设备之间的数据流。控制器插入计算机系统的主板，并通过连接器连接到需要数据传输的设备。一旦建立了数据流，计算机系统就会暂时停止运行，DMA 控制器就会接管工作。此外，我们在 CPU 通过数据总线传输数据时初始化 DMA。

控制器临时控制系统总线，无需 CPU 的任何协助，直接将数据发送到设备。当我们完成传输操作时，DMA 控制器将控制权交给 CPU。因此，系统恢复正常运行。

现在，让我们看一下 DMA 控制器的框图，以便更详细地探索工作过程：

![DMA 工作](https://www.baeldung.com/wp-content/uploads/sites/4/2022/11/DMA-WORKS.drawio-1.png)

为了成功传输数据，DMA 必须与 CPU 共享总线(数据和地址)。现在假设我们要将数据从 I/O 设备传输到内存。在这种情况下，CPU 强制停止当前程序。此外，CPU 将[程序计数器](https://www.baeldung.com/cs/os-program-counter-vs-instruction-register)的值递增1。

此外，CPU 生成一个信号并通过地址总线将其发送到 DMA 控制器。现在，如果 DMA 控制器接受信号，它会生成一个总线请求信号。此外，从 DMA 控制器向 CPU 发送请求以控制总线。如果 CPU 同意请求，则 DMA 控制器成为总线主控器。

此外，CPU 还会发送内存中的地址、数据传输的方向以及数据中的块数。初始化数据传输任务到 DMA 控制器后，CPU 恢复执行。

我们可以将DMA控制器的操作分为两类：单通道和多通道。在单通道操作中，数据从内存传输到一个设备，然后从该设备传输到内存。在多通道操作中，数据同时从内存传输到多个设备。此外，我们还可以将数据从多个设备传输到内存。

通常，计算机上有两种内存：系统内存和 I/O 内存。系统内存存储操作系统和程序数据，而I/O内存存储与[外围设备](https://en.wikipedia.org/wiki/Peripheral)相关的数据。如果计算机想要在没有用户干预的情况下将数据发送到打印机，它必须通过[I/O 内存](https://www.baeldung.com/cs/memory-mapped-vs-isolated-io)来实现。

内存类型的分离至关重要，因为系统内存的运行速度高于 I/O 内存。DMA 控制器在设备和系统内存之间引导数据，使两个设备之间的操作看起来像一个单一的操作。

例如，如果计算机要将数据从系统内存发送到打印机，它会向打印机的 DMA 控制器发出 DMA 传输请求。打印机的 DMA 控制器然后开始数据传输操作，从一端的系统内存中读取数据并将其发送到打印机。

## 5.优点和缺点

DMA 的主要优点是加快数据传输和内存操作。因此，它有助于操作系统正确分配负载。

另一方面，连接到[网络计算机 (NC)](https://en.wikipedia.org/wiki/Network_Computer)的计算机系统不能使用 DMA 控制器来传输数据。当连接到 NC 时，计算机系统必须依靠 CPU 来帮助进行数据传输。此外，在使用 DMA 进行数据传输时，我们会遇到[缓存一致性](https://en.wikipedia.org/wiki/Cache_coherence)问题。

先说说DMA的核心优缺点：

![由 QuickLaTeX.com 呈现](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-f73f933d165ae33e147c17bb87656c8d_l3.svg)

## 六，总结

在本教程中，我们详细讨论了直接内存访问 (DMA)。我们讲了DMA的工作流程。

此外，我们还探讨了 DMA 的几个优点和缺点。