## 1. 概述

作为网络管理员，我们经常在设计和故障排除时遇到公共的、不可路由的地址等术语。这是因为这些地址构成了集群和复杂计算网络——互联网的骨干。

在本教程中，我们将阐明一些原因和方法，例如为什么要使用不可路由的[IP 地址](https://www.baeldung.com/cs/ipv4-vs-ipv6)、带有 NAT 的不可路由 IP 如何帮助扩展 IPv4 互联网，以及它如何为 IPv6 迁移提供临时支持。

## 2.什么是IP地址？

通常，人类使用他们的名字来识别和相互交流。

与这个事实非常相似，机器使用 IP 地址在计算世界中相互识别和交互。因此，网络中连接的任何设备都必须具有唯一的 IP 地址才能与其他设备进行通信。

今天，由于这种独特的寻址技术，互联网得以存在。IANA 管理连接到 Internet 的网络的 IP 地址范围。IP 版本 4 和 6 是可用的两种不同的 IP 寻址模式。前者是传统的和经常使用的 32 位寻址模式，点分十进制表示法，而后者是现代的，新采用的 128 位十六进制，用冒号分隔。

## 3.公共IP地址与私有IP地址

IPv4 寻址有两种类型：公共地址和私有地址。

公共 IP 地址是互联网上一长串全球连接设备的基本结构。它们是唯一的，通过边界网关协议在全球范围内路由，称为全球或 WAN 地址。

另一方面，私有 IP 地址不会在 Internet 上崩溃。因此，它们也被称为不可路由的 IP 地址。它们帮助组织创建其本地网络，而不会将其路由暴露到 Internet。但是，与公网相比，私网的故障排除和维护复杂。

## 4.不可路由的IP地址

互联网上有数十亿人，而且其增长呈指数级增长。由于最多有 40 亿个可用地址，IPv4 地址空间的大小正在快速耗尽。尽管 IPv6 具有诸多优势，但由于许多实际原因，它无法取代 IPv4。因此，两个版本必须共存一段时间才能无缝迁移。

然而，RFC 1918 于 1996 年发布，以应对 IPv4 的枯竭。它引用“在一个称为不可路由地址空间的自治系统中可以有网络。这些定义的 IP 范围可以构建专用或本地网络”。

RFC 1918 中定义了三个不同的 IP 范围。它们是：

-   10.0.0.0/8(范围：10.0.0.0 – 10.255.255.255)- 可用 IP：16,777,214
-   172.16.0.0/12(范围：172.16.0.0 – 172.31.255.255)- 可用 IP：1,048,574
-   192.168.0.0/16(范围：192.168.0.0 – 192.168.255.255) – 可用 IP：65,534

此外，这些专用网络通过 NAT 技术连接到互联网，这将我们带到下一个主题。

## 5.网络地址转换(NAT)

由于互联网的激增，企业和家庭网络的使用量增加，进而导致 IPv4 地址空间枯竭。显而易见的解决方案是用 IPv6 重构整个互联网基础设施，这可能需要几年时间才能实施。

NAT (RFC 1631) 来拯救并填补了这个明显的空白。

NAT 充当 Internet 和专用网络之间的中间人。它工作在 OSI 模型的第 3 层，并在路由器上运行。它使使用不可路由 IP 地址的专用网络能够通过转换后的公共 IP 连接到 Internet。因此，它只对外公布整个私有网络的一个IP地址。

这样，它增强了网络安全性，并在此过程中节省了 IPv4 地址空间。家庭宽带网络就是这种情况的最好例子。

## 6.互联网

[网络](https://www.baeldung.com/cs/popular-network-protocols)是一组通过电缆连接的计算机设备。借助 IP 协议和地址，它们可以相互了解、更新信息和交换数据。

互联网 [互连网络] 是连接全球的计算设备的广泛集合。数据包和协议是互联网的血脉。在这里，数据包包含有关源、目标、应用程序端口和数据的信息，而协议通过 IP 地址确定到达目标的路径。

### 6.1. 互联网流量 - 演练

下图解释了典型的家庭或企业设备如何与互联网上的服务进行通信：

![互联网如何运作？](https://www.baeldung.com/wp-content/uploads/sites/4/2021/12/Internet_Works.jpg)

首先，我们有两个使用不可路由的私有地址构建的网络。这些私人家庭网络有一个 192.168.56.0/24 IP 段，其中计算机和其他通信设备获得一个 IP 进行连接。来自所有这些设备的流量在网关中终止。

此外，路由器上配置的 NAT，所有来自 192.168.56.0/24 网段的传入流量，都会转换为 27.57.30.57 公共 IP。随后，当流量到达 Google(或任何其他目的地)时，它会识别出传入流量来自 27.57.30.57(源 IP 地址)，而不是来自 192.168.56.1(不可路由的私有 IP)。

沿着类似的路线，私有企业网络具有相同的流量。它使用 /8 段来容纳办公室和数据中心中的计算机，IP 段空间的变化很小。随后，10.0.0.0/8 不可路由网段映射到 18.45.87.11 公共 IP 地址以进行 Internet 通信。

同样，到达 Google(或任何其他目的地)的流量将 18.45.87.11 标识为数据包的源 IP 地址，并以此方式隐藏底层 10.0.0.0/8 不可路由专用网络的存在。

此功能增强了组织的网络安全性。根据业务需求，应用感知路由策略可根据流量分类启用数据包优先级。

在这种情况下，私有家庭网络的 254 个可用 IP 地址与一个公共 IP 地址进行了 NAT。同时，一个公共 IP 地址管理着私有企业网络中的 160 万个地址。显然，公共 IP 地址的使用可以节省多倍。

## 七、总结

在本文中，我们了解到为构建私有网络保留的 IP 地址是不可路由的。这个概念的演变是为了防止 IPv4 地址空间耗尽。IPv6 是互联网的未来，但整个互联网基础设施迁移到 IPv6 可能在短时间内不可行。为此，带有 NAT 的不可路由地址作为一种临时解决方案，可以继续在 IPv4 中使用，并为基于 IPv6 的互联网基础设施提供一些喘息时间。