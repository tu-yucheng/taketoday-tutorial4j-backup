## 1. 概述

[传输控制协议(TCP) 是](https://www.baeldung.com/cs/udp-vs-tcp)[因特网协议](https://en.wikipedia.org/wiki/Internet_Protocol)(IP) 传输层使用的面向连接的协议。使用网络连接，TCP 允许服务器和客户端对通过使用数据请求和响应中打包的数据段来交换消息。

在本教程中，我们将学习如何通过发送同步序列号 (SYN) 数据包来启动此连接。

## 2.TCP

TCP 为传输数据提供可靠的连接。此外，TCP 具有内置的错误检查并保证通过其重传和确认过程传输的所有数据的交付。因此，TCP 是 Internet 上使用最流行的协议之一。

该协议需要连接。客户端负责发出启动连接的初始请求。TCP 协议标头中提供的控制位有助于此连接请求。

## 3. 控制位

通常，每个 TCP 请求和响应数据包都以一个标头段开头，其中包含源端口、目标端口、数据包序列号、数据包确认号、数据偏移量、窗口大小、校验和和标志等关键信息。我们的 TCP 客户端需要建立连接，考虑到这个目的，我们将利用数据包标头中可用的标志：

![tcp 头段](https://www.baeldung.com/wp-content/uploads/sites/4/2021/02/tcp-header-segment.svg)

具体来说，我们需要 SYN 标志和 ACK 标志。这些标志是标头中的位，设置为打开时值为 1 或关闭时值为 0。最终，标志是 TCP 客户端和服务器如何确定如何处理他们收到的数据包以及如何响应。那么让我们看看如何使用 SYN 标志来建立连接。

## 4. 3次握手

每当需要进行 TCP 对话时，客户端都会启动并尝试建立连接。服务器被动打开并始终侦听连接。客户端发送到服务器的数据包开始主动打开握手。这是 3 次握手，之所以这样命名，是因为必须执行 3 个步骤才能建立连接。此外，这些步骤中的每一个都需要特定的标志设置。那么，让我们回顾一下每个步骤：

![3次握手](https://www.baeldung.com/wp-content/uploads/sites/4/2021/02/3-way-handshake.svg)

### 4.1. 同步号

首先，客户端发送一个带有序列号的数据包，并且仅在标头中设置了 SYN 标志位 。这个初始数据包允许客户端为来自客户端的请求数据包设置第一个序列号。这是客户端的同步步骤。

### 4.2. 查看/确认

其次，服务器用 SYN/ACK 数据包响应 SYN 数据包。在这里， 服务器设置了 SYN 标志位和 ACK 标志位。此数据包通过确认来确认客户端发送的序列号。但是，服务器还必须向客户端发送一个 SYN 和一个序列号，以设置来自服务器的响应数据包的第一个序列号。和第一步类似，这个响应包就是服务器的同步步骤。

### 4.3. 确认

最后，客户端用确认服务器序列号请求的 ACK 数据包响应 SYN/ACK 数据包。

至此，3 次握手完成，序列号同步，连接建立并可用于将数据发送到服务器。此外，再次使用 SYN 位/数据包很可能会导致协议错误，从而导致连接终止。

## 5.总结

在本教程中，我们学习了如何通过发送正确的数据包来启动和完成 TCP 三向握手，从而在客户端和服务器之间创建 TCP 连接。