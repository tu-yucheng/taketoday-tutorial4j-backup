## 1. 概述

获取机密信息和欺骗身份是数字世界中攻击者的经典目标。 多种攻击可能具有这些目标，例如 [DDoS](https://www.baeldung.com/cs/dos-vs-ddos-attacks) 和某些 [恶意软件](https://www.baeldung.com/cs/virus-vs-worm-vs-trojan)。 当然，互联网协议多年来不断发展以避免此类问题，例如使用[加密技术来保护连接](https://www.baeldung.com/cs/cryptographic-algorithm-complexity)。

然而，随着预防和缓解变得更加复杂，攻击也在不断演变。 在这种情况下出现的相关攻击是中间人 (MITM) 攻击。 中间人攻击包括将攻击者的身份欺骗给旨在与自己通信的合法实体，从而使攻击者能够拦截消息并访问其内容。

在本教程中，我们将研究中间人攻击的真正原理。

首先，我们将了解攻击者执行中间人攻击的典型动机。接下来，我们将了解这次攻击的技术细节。最后，我们将看到现实世界中臭名昭著的中间人攻击案例。

## 2. MITM 攻击的典型动机

自互联网出现和普及以来，机密和敏感信息每天都在万维网上传递。 这些信息的包裹可能具有财务和战略价值，使它们成为黑客窃取的目标。

此外，窃取信息可能会暴露某个系统的弱点。然后，相同的黑客可以探索这些信息以使用不同类别的攻击。

最后，拦截通信，除了使黑客能够获取信息之外，还允许他们创建虚假消息并假冒特定受害者的身份发送它们。这种做法可能会引起一些特定的反应，或者对收到假消息的其他受害者造成一些欺骗。

这样，我们可以将使用 MITM 攻击的动机总结为三点：

-   枚举：拦截通信以发现受害者(数字系统或个人)的弱点和弱点，以进行未来的攻击
-   间谍活动：拦截通信以获取有关某个人或系统的有价值的、机密的和敏感的数据
-   欺骗：修改在 MITM 攻击的受害者之间交换的消息中发送的数据，导致欺骗场景

## 3. MITM 攻击的技术细节

我们可以将中间人攻击概括为两个主要阶段：身份欺骗和流量拦截。

身份欺骗旨在让客户相信攻击者是所需服务的合法服务器。而在流量拦截阶段，攻击者获取并分析客户端发送的网络流量。

我们将在以下小节中详细介绍这些阶段。需要强调的是，我们采用客户端/服务器架构来解释本教程中的中间人攻击，但它也适用于其他架构。

### 3.1. 身份欺骗

身份欺骗阶段的首要目标是让客户相信攻击者实际上是所请求服务的合法服务器。从现在开始，客户端认为他正在与合法服务器通信。但是，网络流量全部指向攻击者。

攻击者收到来自合法客户端的请求并再次欺骗你的身份：攻击者作为客户端与所需服务的合法服务器进行通信。

这样一来，攻击者几乎是看不见的，因为客户端向服务器发送连贯的请求，而合法的服务器自然会响应客户端的请求。

身份欺骗阶段的目标是让攻击者在不可见的情况下充当客户端和服务器之间的通信中介。 这并不意味着攻击者无法修改网络流量中的数据。 这意味着它应该对客户端和服务器都令人信服地完成。

下图描述了所描述的场景：

![身份欺骗](https://www.baeldung.com/wp-content/uploads/sites/4/2022/05/IdentitySpoofing.png)

最后，攻击者可以通过不同的方式拦截从客户端到服务器的流量：

-   ARP 欺骗：攻击者欺骗 ARP 消息，将其 MAC 地址链接到合法服务器 IP，并将其 MAC 地址链接到客户端 IP
-   IP欺骗：攻击者拦截核心网络中的流量并将数据包的源或目标IP地址修改为攻击者
-   DNS 欺骗：攻击者通过使用攻击者的 IP 更改提供给定服务的合法服务器的 IP 地址来毒化 DNS 服务器

选择这些方法之一取决于，例如，攻击者和受害者所在的位置以及他们使用哪些协议相互通信。

### 3.2. 交通拦截

在向服务器和客户端欺骗你的身份后，攻击者最终充当调解两个合法实体之间通信的人。 这意味着攻击者拦截了本次通信中发送或接收的所有网络流量。

然而，这个阶段远非容易的部分！

攻击者必须保持客户端和服务器之间的透明通信。因此，换句话说，合法实体不应注意到攻击者拦截通信的流量。

这样，如果攻击者只是在枚举漏洞或监视客户端，他应该避免降低合法实体之间的通信质量。

相反，如果延迟或丢包率等增加太多，则客户端或服务器可能会怀疑受到攻击。因此，他们可以断开连接或停止发送消息。

下图举例说明了前面描述的场景：

![检查](https://www.baeldung.com/wp-content/uploads/sites/4/2022/05/Inspecting.png)

此外，攻击者在修改拦截的网络流量时会格外小心。因此，修改必须具有足够的说服力，以诱导客户执行某些所需的操作。

攻击者想要采取的行动的具体例子是： 客户提供一些特定的个人信息；在所访问的服务方面对客户造成欺骗；诱导客户端与另一台服务器通信，通常是恶意的并由攻击者控制。

为此，攻击者可以更改服务器发送给客户端的表单、图像、文本和广告。

下图描述了在截获的通信中修改数据的过程：

![改变2](https://www.baeldung.com/wp-content/uploads/sites/4/2022/05/Altering2.png)

总之，对于攻击者来说，流量拦截阶段必须在实现拦截通信的目标与保持拦截透明之间取得平衡。

## 4. 中间人攻击案例

虽然我们将 MITM 攻击与数字世界联系起来，但透明地拦截消息并操纵它们是一种历史策略。

臭名昭著的旧 MITM 是巴宾顿阴谋：计划于 1586 年暗杀英国女王伊丽莎白一世。在这种情况下，MITM 攻击涉及双重代理人和密码分析员。于是，玛丽·斯图尔特(阴谋领袖)与其他阴谋者之间的信件被截获、破译、泄露给英国王室，最后交付给阴谋者。

MITM 攻击的另一个早期例子发生在第二次世界大战中。盟军连续监视德国的无线电传输。德国的传输一结束，盟军就开始以相同的射频重新传输相同的信息。

这样，盟军的传输就与德国的传输混淆了。于是，盟军利用这种情况，在重传的德文消息之间进行了恶搞和方便的消息传递。

近年来，我们在数字世界中也发生了几起中间人攻击事件。

例如，DigiNotar 注册系统在 2011 年被攻破，泄露了 Google 和 Skype 等著名网站的五百多个证书。攻击者利用这些证书创建镜像网站，冒充合法网站。 反过来，这些镜像网站可用于执行 MITM 攻击。

另一个例子是 2017 年的信用评分 Equifax 应用程序。 该应用程序没有适当地使用[HTTPS 协议](https://www.baeldung.com/cs/https-urls-encrypted#https)。因此，攻击者可以在用户访问应用程序时拦截和获取数据。

## 5.总结

在本教程中，我们研究了中间人攻击。 首先，我们了解了执行 MITM 攻击的主要动机。因此，我们看到 MITM 攻击有两个主要阶段：身份欺骗和流量拦截。然后，我们详细分析了这些阶段中的每一个阶段。最后，我们确定了历史和最近的 MITM 攻击示例。

中间人攻击涉及全球数字安全专家。大多数此类攻击对用户而言都是透明的，这使它们成为对最终用户的真正威胁。

这样，开发人员和服务维护人员采用反制措施来尽可能避免 MITM 是非常重要的。反制措施的示例包括应用稳健的加密协议以及多因素和多阶段身份验证。