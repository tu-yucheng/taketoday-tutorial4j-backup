## 1. 概述

如今，我们知道 API 如何成为任何成功数字产品的核心。因此，适当的 API 管理至关重要。

在这个快速教程中，我们将学习两个可以帮助我们朝这个方向发展的对象，即反向代理、API 网关，以及它们的区别。

## 2. 架构

正如我们将在下面看到的，它们可以提供的功能在两者之间有所不同，但它们在基础架构中占据的拓扑结构和位置是相同的。出于这个原因，我们可以用同样的方式来描述它们，如下所示：

![API 网关与反向代理2](https://www.baeldung.com/wp-content/uploads/sites/4/2021/09/API-Gateway-vs-Reverse-Proxy2.png)

## 3.反向代理

使用反向代理变得有用的原因之一是将其用作[客户端](https://www.baeldung.com/cs/client-vs-server-terminology)和一个或多个[后端服务器](https://www.baeldung.com/cs/client-vs-server-terminology)之间的中介。
让我们想象一下拥有一个[微服务架构](https://www.baeldung.com/cs/microservices-cross-cutting-concerns)，并看到它们随着项目的发展而增加。在某个时刻，API 表面的异构性所赋予的复杂性可能会出现需要掩盖所有这些复杂性。为此，反向代理可以重写 URL。客户端不知道谁在反向代理之外。反向代理的责任是将请求转发到可以完成它的后端。

反向代理的典型用途包括：

-   负载平衡：它提供了跨多个后端服务器分配传入请求的能力。这种负载平衡可防止单个系统过载并补偿后端故障。如果后端由于某些错误而无法访问，则其负载平衡模块会将传入请求重新分配给其余后端
-   防止攻击：它提供了安装控制系统的可能性，例如防病毒或数据包过滤器，它们通过将自身定位在 Internet 和专用网络之间，进一步保护后端
-   缓存：对于重复出现的请求，它可以自主地、部分地或完全地回答。内容通常保存在代理缓存中。这样，从后端检索的数据更少，客户端在更短的时间内得到响应
-   SSL 加密：它可以配置为解密所有传入请求并加密所有传出响应，从而释放后端的宝贵资源

此时，如果所有这些功能还不够，我们可能需要一个 API 网关。让我们深入研究 API 网关进一步提供的功能。

## 4.API网关

我们可以将网关 API 视为反向代理的超集。接下来，我们将讨论它必须提供的附加功能。

首先，API 网关向客户端隐藏了后端在架构中的划分方式。不仅通过转发请求，而且可能执行编排/聚合。这简化了客户端代码并减少了 API 请求/往返次数。此外，客户端不会调用多个后端，而是只与 API 网关对话。

与处理请求/响应相关的另一个功能是协议转换。换句话说，API 网关可以执行从协议到协议的转换(例如，XML 到 JSON，gRPC 到 JSON)以促进客户端和服务器之间的集成。

API 网关是解决一些常见能力(例如安全性、可靠性、可扩展性、可观察性和可追溯性)的强大驱动程序。让我们看看如何。

首先是安全性，它提供：

-   [身份验证和授权](https://www.baeldung.com/cs/authentication-vs-authorization)：它集中在边缘谁可以请求什么
-   IP 白名单：它可以授予仅对特定 IP 地址使用 API 的能力

继续与性能相关的那些：

-   [Rate Limiting](https://www.baeldung.com/spring-bucket4j#api-rate-limiting)、 Throttling 和 Quota：我们可以根据特定时间单位内可以处理多少请求/数据服务器来设置限制。此外，更多地关注商业方面，它提供了根据 API 消费者购买的计划来控制他们使用的流量的可能性
-   重试策略和[断路器](https://martinfowler.com/bliki/CircuitBreaker.html)：这些用于通过管理后端的临时不可用性来提高后端的弹性和可靠性(例如，代表客户端重新执行请求或保护服务器免于被请求淹没)

总结可观察性和可追溯性：

-   记录、跟踪、关联：收集每个特定请求的所有日志，了解它涉及哪些后端以及相关指标

## 5. 差异

总而言之，既然我们已经分别看到了两者，那么让我们总结一下反向代理和 API 网关之间的主要区别：

![由 QuickLaTeX.com 呈现](https://www.baeldung.com/wp-content/ql-cache/quicklatex.com-817587a33b02837caee9efa3218b6eb0_l3.svg)

## 6。总结

在本文中，明确了API Gateway和Reverse Proxy的职责后，我们就可以根据要求的简洁性以及需求和我们要解决的问题进行适当的选择。