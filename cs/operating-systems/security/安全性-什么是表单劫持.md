## 1. 概述

在本教程中，我们将研究表单劫持攻击。随着当今互联网的异构和多种用途，我们已经期望通过网络传输一些增值或敏感数据。因此，将数据从用户发送到服务提供商的一种方法是使用 Web 表单。但是，攻击者可能会利用这些表单在表单劫持攻击中窃取信息。

在下一节中，我们将研究 Web 表单的真正含义及其工作原理。然后，在第三部分中，我们将探索表单劫持攻击。我们将专注于网络服务如何被感染以及最常见的后果。然后，我们总结概念并在总结部分提出最后的评论。

## 2. 网页表格

Web 表单允许用户与在线提供的服务进行通信。使用这些表单，用户发送数据以访问、请求和执行此类服务。为此，用户根据提供的说明填写一系列字段。

几个不同的元素可以组成一个表单。最常见的元素是文本字段(允许用户键入文本)、选择框(允许用户从列表中选择一个选项)和复选框(允许用户从提供的选项中标记所需的选项)。

此外，Web 表单通常提供按钮来触发某些操作。例如用于发送和清理数据的按钮。

下图显示了一个常见形式的简单示例：

![网络表格](https://www.baeldung.com/wp-content/uploads/sites/4/2022/09/WebForm.png)

我们应该尝试许多方面来开发 Web 表单，从人机交互的设计到我们将用来实现它们的技术和库。

从业务的角度来看，表单通过简单的事务、直接的说明和清晰的元素标题促进了用户和服务之间的通信。

从技术的角度来看，Web 表单又由无数的库(例如用于构建图形界面和通信点)、协议(例如[HTTP/REST](https://www.baeldung.com/cs/rest-architecture))和技术(例如[网络](https://www.baeldung.com/cs/category/networking)、数据库和[身份验证](https://www.baeldung.com/cs/authentication-vs-authorization)等)。

## 3. 劫持攻击

在高层次上，表单劫持攻击发生在用户填写给定的 Web 表单并提交数据以供系统处理之后。此时，来自 Web 表单的数据不仅会发送到系统，还会发送给之前使用恶意脚本感染表单的攻击者。

然而，所描述的过程只是一个高级工作流。关于表单劫持，有很多事情要讨论。例如，我们可以讨论攻击者通过执行表单劫持攻击可以获得的动机和潜在利益。

在这种情况下，我们首先要知道的是“数据总是相关的”；通过来自同一表单的大量数据，我们可以找到模式并确定用户行为。该信息以及收集的数据本身具有市场和货币价值。

因此，攻击者可能会向他们所攻击的竞争公司提供特权数据和信息。

攻击者执行表单劫持的另一个动机是通过攻击特定类别的 Web 表单来获得直接的经济利益。这些表单的示例是需要用户信用卡数据的表单。

通过这种方式，攻击者可以直接使用收集到的数据来骗取信用卡并使用它们进行多次在线购买。

因此，正如到目前为止所讨论的，执行劫持攻击需要观察三个步骤：

-   感染提供表单的实体：从技术上讲，一旦它包括以某种方式访问受害服务器，最具挑战性的步骤
-   等待用户填写并提交受感染的表单：攻击者无法感染从未使用过的 Web 表单。产生大量流量的 Web 表单通常是首选
-   接收和使用数据：攻击者会谨慎使用窃取的数据，避免被发现或明确哪些感染形式是

### 3.1. 感染

考虑到前面介绍的表单劫持攻击步骤，让我们在本小节中讨论感染 Web 表单的最典型方法。

首先，我们应该声明攻击者可以感染 Web 表单而无需直接访问托管它的服务器。当然，直接访问服务器会使攻击更容易。但是，这不是通常的表单劫持场景中发生的情况。

总之，我们可以列举三个非常相关的感染场景：一个与提供的服务及其维护者密切相关，两个与最终用户有关。

因此，关于服务及其维护者，我们有：

-   来自不可信来源的库/代码：即使是可信来源提供的库也可能存在一些安全问题。但是，从不受信任的来源导入库(或使用代码)存在明显的风险。如果没有适当的评估，就很难保证该库不包含一些执行 formjack 攻击的恶意代码

另一方面，我们也应该注意利用给定服务的用户的攻击者，例如：

-   不受信任的软件访问表单：我们不控制用户在他们的计算机上使用什么(就软件而言)。因此，有时，表单劫持攻击可能来自用户端，例如由恶意浏览器或恶意浏览器扩展启用
-   DNS 欺骗：另一种可能性是为给定服务的用户欺骗[DNS](https://www.baeldung.com/cs/dns-intro)消息，使他们访问恶意形式。反过来，此表格看起来与原始表格相同，但它仅用于窃取提供的数据

下图描述了两种讨论的感染场景，它们利用用户执行劫持攻击：

![漏洞劫持](https://www.baeldung.com/wp-content/uploads/sites/4/2022/09/ExploitsFormjacking-1.png)

我们看到了受劫持攻击影响的多种形式。但是，有预防措施和对策。让我们在下一节中看到其中的一些。

### 3.2. 预防与对策

针对表单劫持攻击的第一个也是最相关的预防措施是“始终使用受信任的资源”。这是开发者和用户双方的行动。 

在开发人员方面，使用受信任的资源意味着验证每个导入的代码或库。然而，在用户方面，受信任的资源意味着使用经过验证的浏览器、扩展程序和在后台运行的任何其他软件。

服务维护者和提供者的其他预防措施是使用安全解决方案并运行渗透和泄漏测试。因此，可以检测异常系统操作并进行调查。

对于用户而言，跟踪个人财务信息至关重要。许多劫持攻击旨在窃取面包店信息和信用卡号码。因此，如果我们发现我们的银行账户有任何异常变动，我们应该立即冻结它们，通知负责机构，并要求他们提供新的凭证。

## 4。总结

在本教程中，我们研究了表单劫持攻击。首先，我们回顾了 Web 表单的主要概念及其工作原理。因此，我们专门研究了什么是表单劫持攻击以及攻击者如何执行它们。此外，我们还看到了针对这些攻击的潜在预防和对策。

我们可以得出总结，劫持攻击确实代表了数字世界中的相关威胁。因此，一旦通过 Web 表单提供了大量敏感数据，如今避免表单劫持攻击就成为当务之急。 