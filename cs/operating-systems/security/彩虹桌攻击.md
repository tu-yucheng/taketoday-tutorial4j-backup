## 1. 概述

如今，有多种机制旨在提供数字世界中的安全性、隐私性和真实性。在这些机制中，我们可以找到哈希函数。散列是一种映射技术，它将任意大小的给定字节序列转换为另一个预定大小的字节序列。

值得注意的是，散列法有很多应用。例如，散列适用于存储密码和[创建数字签名](https://www.baeldung.com/cs/encoding-vs-signing-asymmetric-encryption#signing-data-with-asymmetric-encryption)。

然而，与旨在提供安全性的每一种机制一样，哈希具有特定的漏洞。因此，攻击者利用这些漏洞来破坏安全机制。

在本教程中，我们将研究一种特定的哈希攻击：彩虹表攻击。最初，我们将概述必要的散列概念。因此，我们将研究彩虹表的中心思想。最后，我们将探索彩虹表攻击本身，展示一个简单的例子。

## 2.散列

实际上，散列是一种映射技术。它使用一个函数将字节序列转换为其他字节序列。提供给散列函数的数据可能具有可变长度。但是，哈希函数中生成的数据(称为哈希码或摘要)始终具有相同的长度。

下图描述了所描述的过程：

![哈希](https://www.baeldung.com/wp-content/uploads/sites/4/2022/01/Hashing.png)

值得注意的是，哈希函数是一种单向函数。因此，仅给定哈希码是不可能恢复原始明文输入的。

散列的一个特点是存在有限数量的散列码。哈希码的长度定义了这个数字。

因此，由于输入的长度是可变的且不受限制，我们将无限大小集映射到有限大小集。这意味着，在某些时候，不同的明文输入将生成相同的哈希码。这种现象称为碰撞。

然而，为了解决冲突并获得额外的安全层，可以执行一种称为散列加盐的操作。加盐包括使用另一个单向函数减少明文(不同于原始输入)中的哈希码，然后再次对其进行哈希处理，生成与前一个不同的代码。

下图直观地展示了哈希的加盐过程：

![盐](https://www.baeldung.com/wp-content/uploads/sites/4/2022/01/Salting.png)

## 3. 彩虹桌

彩虹表是预先计算的表，用于将哈希码还原为原始输入明文。简而言之，这些表在经过一些散列和归约操作后，将原始输入明文与相应的散列码相关联。

彩虹表作为一种中期解决方案应运而生：它们不需要在每次请求时执行所有哈希/归约操作，并且比使用将直接哈希代码与原始明文相关联的查找表提供更好的安全性。

在这种情况下，查找表基本上是带有非加盐哈希码的彩虹表。

总之，为每个输入处理多个哈希和归约需要大量时间。否则，为给定输入保留哈希码的所有可能性需要大量内存。

通过在明文输入和最终代码之间建立关系，彩虹表促进了散列操作的一般管理。

下图举例说明了一个简单的彩虹表：

![桌子](https://www.baeldung.com/wp-content/uploads/sites/4/2022/01/Table.png)

## 4. 彩虹桌攻击

总之，彩虹表攻击将窃取的哈希码与给定哈希方法的彩虹表进行比较。

这样，彩虹表攻击的第一步就是窃取哈希列表。通常，这些散列包含私人信息，例如密码和信用卡号。

攻击者可以窃取哈希列表，例如，通过利用安全性较差的数据库的漏洞或使用网络钓鱼技术。

获得哈希值后，攻击者将它们与彩虹表进行比较，旨在找到它们与表条目之间的某些匹配项。如果匹配，攻击者将获得散列的明文。

例如，使用原始明文输入，攻击者可以尝试访问帐户(如果明文对应密码)或网上购物(如果明文对应信用卡号和其他信息)。

### 4.1. 示例场景

通常，彩虹表攻击与其他类型的攻击一起发生。发生这种情况是因为有必要访问哈希码列表，这可能需要其他攻击技术。

让我们考虑一个可能的场景：首先，攻击者在易受攻击的 Web 服务器中执行 SQL 注入以读取数据库。接下来，攻击者搜索密码表并访问其数据。最后，利用密码哈希码列表，攻击者使用彩虹表获取明文数据。

另一种可能的情况是执行分布式拒绝服务攻击以破坏安全系统(例如防火墙)。因此，攻击者可以入侵数据库系统，窃取哈希码列表，并执行彩虹表攻击。

### 4.2. 对策

除了保护保留哈希码的数据库外，还可以采用其他对策来避免彩虹表攻击。接下来我们将描述其中的一些对策：

-   提高安全性：防止彩虹表攻击造成灾难性后果的一个好选择不仅仅依赖于密码安全性。在这种情况下，多因素身份验证是提高安全性的一个很好的选择
-   不要使用简单的密码：大多数彩虹表中都有常用密码，例如 0123456 和 qwerty。因此，使用大的和不寻常的密码会降低它被映射到通用彩虹表中的可能性
-   使用加盐技术：加盐使得执行彩虹表攻击变得更加困难。此外，在归约操作中消除字母数字字符也可以提高安全性
-   使用现代哈希算法：过时的哈希算法，例如 [MD5](https://www.baeldung.com/java-md5) 和 SHA1，是彩虹表攻击的首选——最好避免使用它们

## 5.总结

在本教程中，我们了解了彩虹表攻击。 首先，我们回顾了哈希的基本概念。因此，我们专注于了解什么是彩虹表。接下来，我们深入研究了彩虹表攻击。在此背景下，我们探讨了概念、场景和可能的对策。

我们可以得出总结，哈希是当前 Internet 的一项基本技术。然而，与任何安全技术一样，它也有一些被恶意攻击者发现的弱点。因此，为了确保我们的系统安全，必须了解这些弱点并准备适当的对策以避免可能的攻击。